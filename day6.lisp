(in-package #:aoc-2023)

;; https://adventofcode.com/2023/day/6

(defun d6-data (&optional ignore-ws-p)
  (with-local-file (stream "day6.txt")
    (let ((races (cons NIL NIL))
          (num-re (cl-ppcre:create-scanner "\\b\\d+\\b"))
          (line (read-clean-line stream)))
      (flet ((parse-line (line)
               (let ((nums (cl-ppcre:all-matches-as-strings num-re line)))
                 (if ignore-ws-p
                     (parse-integer (format NIL "濑铛眢┅磲疸狎＇疳蝮瀛轭翦珏铛眢┅┅躅戾篌ㄡ钿篝蜷铉扉铄篝蜷铉⒃轫搴篚怏羼扉铄旦┅ㄥ蝌矧⑸铞犰殇糸礤扉铄幄扉铄┅箦翩ㄣ狎蜥沐螬疳蝮瀛扉铄扉铄┅箦翩扉铄蝈徜沆遽瞽扉铄篝蝈犴┅躅戾篌ㄡ钿篝蜷铉扉铄篝蜷铉⒛轶翎钽搴篚怏羼扉铄供┅ㄥ蝌矧⑸铞犰殇溟篝犷沐扉铄幄扉铄┅箦翩ㄣ潋蜥沐螬疳蝮瀛扉铄扉铄┅箦翩扉铄蝈徜沆遽瞽扉铄篝蝈犴┅躅戾篌ㄥ耢扉铄哄镦ㄥ蝌矧⒄铄疱泗邃泔铘孱艉幄扉铄┅蜥沐螬┅ㄤ邈灬轫ㄩ铎轭涠溟篝犷沐┅ㄤ彐躅涠溟篝犷沐ㄨ镬扉黹舂í栾熹磲ō扉黹栾熹┅┅ㄤ彐躅涠鸨ī祜镳鏖翳糸礤溟篝犷沐螬ㄤ董溽翎鏖翳蝈赧犰骘糸礤轭糸礤骘溟篝犷沐轭溟篝犷沐骘黹瞽栾熹糸礤骘磲栾熹骘骘躅洵铋滹ㄤ雉轫弩ㄩ糸礤戾è溟篝ㄤ董溟篝犷沐糸礤┅ㄣ镱è犷骘躅洵溟篝溟篝犷沐┅蝈趱蝾┅è溟篝犷沐溟篝麒孱黹瞽栾熹箦翩黹瞽栾熹椹箦翩磲栾熹椹箦翩骘躅洵舂┅┅滹箦翩蝈赧犰í蝈赧犰ūō磲栾熹黹瞽栾熹┅┅骈钺祆蝈趱蝾蝈赧犰┅换令篦弪复俺扯ㄤ彐躅涠怏遽蜚ㄨ殓璀忉箦麸翎蜱弭扉黹舂祜镳鏖翳戾骠忉箦鏖翳蜷玷麸骘栾熹ㄦ祜矧ǐ戾骠蜷玷舂博骘溟篝犷沐ㄤ董溟篝犷沐栾熹扉黹舂滹ㄣ镱è溟篝犷沐翎蜱弭箦翩戾骠ū栾熹┅è翎蜱弭溟篝犷沐箦翩蜷玷ū栾熹┅┅躅糸矧溟篝犷沐翎蜱弭蜷玷戾骠┅骈钺祆蝈趱蝾ㄩ翎蜱弭溟篝犷沐祜镳骘鲠祯栾熹翳孱ㄩ栝玷ū鲠祯濠ū鲠祯濠麒殪翎蜱弭ㄤ董溟篝犷沐鲠祯扉黹舂骈钺祆蝈趱蝾ㄩ栝玷ū鲠祯濠ū鲠祯濠┅祜镳骘鲠祯栾熹翳孱ㄩ栝玷ū鲠祯濠ū鲠祯濠躅糸翎蜱弭ㄤ董溟篝犷沐鲠祯扉黹舂骈钺祆蝈趱蝾鲠祯濠┅┅ㄤ彐躅涠鸩ī戾舄è糸礤溟篝犷沐ㄤ董溽翎冤糸礤ㄣ狎糸礤溟篝犷沐┅翎蜱弭ㄣ潋糸礤溟篝犷沐┅ㄨ犰ㄦ祜矧糸礤博┅换物翦忮汜躞翳躔疱邃珏轶轭沆躞轹瀹ōūㄤ董怏遽蜚ū栳戽糸礤翎蜱弭糸礤┅ㄤ董怏遽蜚紊栳戽翎蜱弭糸礤┅┅换令篦弪幢掣驳豆